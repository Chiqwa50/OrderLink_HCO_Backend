1. "أريد تعديل منطق المستخدمين في النظام بحيث يدعم إدارة مشرفي الأقسام ومشرفي المستودعات وفق المتطلبات التالية:

   ## أولاً: إدارة الأقسام والمستودعات

   1. **Module إدارة الأقسام**:
      - إنشاء قسم جديد.
      - تعديل بيانات قسم.
      - تعطيل أو حذف قسم.
   2. **Module إدارة المستودعات**:
      - إنشاء مستودع جديد.
      - تحديد نوع المستودع (دوائي، لوجستي، أجهزة، ...).
      - تفعيل أو إلغاء تفعيل المستودع.

   ------

   ## ثانياً: تعديل منطق إنشاء المستخدمين (Users)

   عند إنشاء أو تعديل المستخدم، يجب أن يكون النظام عند اختيار دور المستخدم قسم أو مستودع  كالآتي:

   - مشرف قسم (Department Supervisor)
   - مشرف مستودع (Warehouse Supervisor)

   1. **إذا كان المستخدم = مشرف قسم**:
      - تظهر قائمة بجميع الأقسام النشطة.
      - يمكن اختيار قسم واحد أو عدة أقسام.
      - يتم تخزين العلاقات في جدول `department_supervisors` بشكل:
        - (user_id + department_id)
   2. **إذا كان المستخدم = مشرف مستودع**:
      - تظهر قائمة بجميع المستودعات النشطة.
      - يمكن اختيار مستودع واحد أو عدة مستودعات.
      - أو تحديد خيار (مشرف عام لجميع المستودعات).
      - يتم تخزين العلاقات في جدول `warehouse_supervisors` بشكل:
        - (user_id + warehouse_id + is_global)
   3. عند فتح شاشة تعديل المستخدم:
      - تُعرض الأقسام المرتبطة به إذا كان مشرف قسم.
      - تُعرض المستودعات المرتبطة به إذا كان مشرف مستودع.
      - يمكن إضافة/حذف ارتباط الأقسام أو المستودعات.

   ------

   ## ثالثاً: منطق الطلبيات (Orders)

   عند إنشاء الطلبية من مشرف قسم:

   1. يتم ربط الطلبية بالقسم الذي أرسلها.
   2. تحديد المستودع المستهدف يتم عبر أحد الخيارات:
      - **الخيار A:** إذا كان القسم مرتبطاً بمستودع معيّن → يتم توجيه الطلبية تلقائياً إليه.
      - **الخيار B:** إذا لم يكن القسم مرتبطاً بأي مستودع → تظهر الطلبية لجميع مشرفي المستودعات ليتم استلامها من أي مشرف.
      - **الخيار C:** يمكن لمشرف القسم اختيار المستودع يدوياً من القائمة (إن كان هذا الخيار مفعّلاً للإدارة).
   3. مشرف المستودع يشاهد فقط الطلبيات الخاصة بالمستودعات المرتبطة به، باستثناء الحالة التالية:
      - إذا كان `is_global = 1` → يشاهد جميع الطلبيات.

   ------

   ## رابعاً: واجهة المستخدم (UI)

   - عند مشرف القسم:
     - تظهر الأقسام التي يشرف عليها فقط.
     - عند إنشاء طلبية: تظهر قائمة المستودعات حسب الإعدادات المذكورة.
   - عند مشرف المستودع:
     - تظهر له فقط الطلبيات الخاصة بالمستودعات المحددة له.
     - إذا كان مشرف عام لجميع المستودعات → تظهر له كل الطلبيات.

   ------

   أريد منك تنفيذ هذا النظام عبر:

   - تحديث قاعدة البيانات (Database Schema)
   - تحديث الـ API
   - تحديث الواجهات (UI)
   - وربط جميع هذه المنظومات بالمنطق المذكور."







الان نريد منطق صحيح لعميلة الطلبات من قبل مستخدم القسم هوا ان الطلبية يتم توجيها إلى إلى المستودع الصحيح وهوا تعرض إلى مشرفي المستودع المطلوب التوجيه إليه .
المنطق هوا ان يتم ربط القسم بمستودع عن انشاء قسم جديد يمكن ان يتم تحديد مستودع او is_global  يعرض لجميع المستودعات 