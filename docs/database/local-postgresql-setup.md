# Local PostgreSQL Database Setup Guide

**Title**: ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุจูุงูุงุช PostgreSQL ุงููุญููุฉ ูู OrderLink

**Summary**: ุฏููู ุดุงูู ูุฅุนุฏุงุฏ ูุงุณุชุฎุฏุงู ูุงุนุฏุฉ ุจูุงูุงุช PostgreSQL ูุญููุฉ ููุชุทููุฑ

**Purpose**: ุชูููุฑ ุชุนูููุงุช ุฎุทูุฉ ุจุฎุทูุฉ ูุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ ูุงูุนูู ุนูููุง

---

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุจูุงูุงุช PostgreSQL ูุญููุฉ ููุชุทููุฑ ุจูุฌุงุญ. ูุฐุง ุงูุฏููู ููุถุญ ููููุฉ ุงุณุชุฎุฏุงููุง ูุงูุนูู ุนูููุง.

---

## ูุนูููุงุช ุงูุงุชุตุงู

### ุจูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ

```bash
Host:     localhost
Port:     5432
Database: orderlink
Username: postgres
Password: password
```

### ุฑุงุจุท ุงูุงุชุตุงู (DATABASE_URL)

```
postgresql://postgres:password@localhost:5432/orderlink?schema=public
```

---

## ุงูุฌุฏุงูู ุงูููุดุฃุฉ

ุชู ุฅูุดุงุก 4 ุฌุฏุงูู ุจูุฌุงุญ:

### 1. `users` - ุฌุฏูู ุงููุณุชุฎุฏููู
- ูุนุฑู ูุฑูุฏ (UUID)
- ุฑูู ุงููุงุชู (ูุฑูุฏ)
- ูููุฉ ุงููุฑูุฑ (ูุดูุฑุฉ)
- ุงูุงุณู
- ุงูุฏูุฑ (ADMIN, WAREHOUSE, DRIVER, DEPARTMENT)
- ุงุณู ุงููุณู (ููุฃูุณุงู ููุท)
- ุชุงุฑูุฎ ุงูุฅูุดุงุก ูุงูุชุญุฏูุซ

### 2. `orders` - ุฌุฏูู ุงูุทูุจุงุช
- ูุนุฑู ูุฑูุฏ (UUID)
- ุฑูู ุงูุทูุจ (ูุฑูุฏุ ุชููุงุฆู)
- ูุนุฑู ุงููุณู
- ุงูุญุงูุฉ (PENDING, REVIEWING, PREPARING, READY, DELIVERED, CANCELLED)
- ููุงุญุธุงุช
- ุชุงุฑูุฎ ุงูุฅูุดุงุก ูุงูุชุญุฏูุซ

### 3. `order_items` - ุฌุฏูู ุนูุงุตุฑ ุงูุทูุจ
- ูุนุฑู ูุฑูุฏ (UUID)
- ูุนุฑู ุงูุทูุจ
- ุงุณู ุงููุงุฏุฉ
- ุงููููุฉ
- ููุงุญุธุงุช

### 4. `order_history` - ุฌุฏูู ุณุฌู ุงูุทูุจุงุช
- ูุนุฑู ูุฑูุฏ (UUID)
- ูุนุฑู ุงูุทูุจ
- ุงูุญุงูุฉ ุงูุฌุฏูุฏุฉ
- ูุนุฑู ุงููุณุชุฎุฏู ุงูุฐู ูุงู ุจุงูุชุบููุฑ
- ููุงุญุธุงุช
- ุงูููุช

---

## ุงููุณุชุฎุฏููู ุงูุชุฌุฑูุจููู

ุชู ุฅูุดุงุก 6 ูุณุชุฎุฏููู ุชุฌุฑูุจููู ููุงุฎุชุจุงุฑ:

### ๐จโ๐ผ ูุฏูุฑ ุงููุธุงู (Admin)
```
ุฑูู ุงููุงุชู: 0900000000
ูููุฉ ุงููุฑูุฑ: admin123
ุงูุฏูุฑ: ADMIN
```

### ๐ฆ ููุธู ุงููุณุชูุฏุน (Warehouse)
```
ุฑูู ุงููุงุชู: 0900000001
ูููุฉ ุงููุฑูุฑ: warehouse123
ุงูุฏูุฑ: WAREHOUSE
```

### ๐ ุณุงุฆู ุงูุชูุตูู (Driver)
```
ุฑูู ุงููุงุชู: 0900000002
ูููุฉ ุงููุฑูุฑ: driver123
ุงูุฏูุฑ: DRIVER
```

### ๐ฅ ูุดุฑูู ุงูุฃูุณุงู (Departments)

**ูุณู ุงูุทูุงุฑุฆ**
```
ุฑูู ุงููุงุชู: 0900000003
ูููุฉ ุงููุฑูุฑ: dept123
ุงูุงุณู: ุฃุญูุฏ ูุญูุฏ
ุงููุณู: ูุณู ุงูุทูุงุฑุฆ
```

**ูุณู ุงูุนูููุงุช**
```
ุฑูู ุงููุงุชู: 0900000004
ูููุฉ ุงููุฑูุฑ: dept123
ุงูุงุณู: ูุงุทูุฉ ุนูู
ุงููุณู: ูุณู ุงูุนูููุงุช
```

**ูุณู ุงูุนูุงูุฉ ุงููุฑูุฒุฉ**
```
ุฑูู ุงููุงุชู: 0900000005
ูููุฉ ุงููุฑูุฑ: dept123
ุงูุงุณู: ุฎุงูุฏ ุณุนูุฏ
ุงููุณู: ูุณู ุงูุนูุงูุฉ ุงููุฑูุฒุฉ
```

---

## ุงูุฃูุงูุฑ ุงููููุฏุฉ

### ุฅุฏุงุฑุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช:**
```bash
psql -U postgres -h localhost -d orderlink
```

**ุนุฑุถ ุฌููุน ุงูุฌุฏุงูู:**
```bash
psql -U postgres -h localhost -d orderlink -c "\dt"
```

**ุนุฑุถ ุจูุงูุงุช ุฌุฏูู ุงููุณุชุฎุฏููู:**
```bash
psql -U postgres -h localhost -d orderlink -c "SELECT id, phone, name, role, department_name FROM users;"
```

**ุญุฐู ุฌููุน ุงูุจูุงูุงุช (ุงุญุฐุฑ!):**
```bash
psql -U postgres -h localhost -d orderlink -c "TRUNCATE users, orders, order_items, order_history CASCADE;"
```

**ุญุฐู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุงููุงูู:**
```bash
psql -U postgres -h localhost -c "DROP DATABASE orderlink;"
```

### ุฃูุงูุฑ Prisma

**ูุชุญ Prisma Studio (ูุงุฌูุฉ ุฑุณูููุฉ):**
```bash
cd backend
npx prisma studio
```
ุณููุชุญ ุนูู: http://localhost:5555

**ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุฌุฏุงูู:**
```bash
cd backend
npx prisma db push
```

**ุฅุนุงุฏุฉ ุชุนุจุฆุฉ ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ:**
```bash
cd backend
npm run seed
```

**ุชูููุฏ Prisma Client ุจุนุฏ ุชุนุฏูู Schema:**
```bash
cd backend
npx prisma generate
```

---

## ุงุฎุชุจุงุฑ ุงูุงุชุตุงู

### 1. ุงุฎุชุจุงุฑ Backend API

ุชุฃูุฏ ูู ุชุดุบูู ุงูุฎุงุฏู:
```bash
cd backend
npm run dev
```

ุงุฎุชุจุฑ endpoint ุงูุตุญุฉ:
```bash
curl http://localhost:5000/health
```

ุงููุชูุฌุฉ ุงููุชููุนุฉ:
```json
{
  "status": "OK",
  "message": "OrderLink API is running"
}
```

### 2. ุงุฎุชุจุงุฑ ุชุณุฌูู ุงูุฏุฎูู

```bash
curl -X POST http://localhost:5000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "0900000000",
    "password": "admin123"
  }'
```

ุงููุชูุฌุฉ ุงููุชููุนุฉ:
```json
{
  "message": "ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ",
  "token": "eyJhbGciOiJIUzI1NiIs...",
  "user": {
    "id": "...",
    "phone": "0900000000",
    "name": "ูุฏูุฑ ุงููุธุงู",
    "role": "ADMIN"
  }
}
```

### 3. ุงุฎุชุจุงุฑ Frontend

ุชุฃูุฏ ูู ุชุดุบูู Frontend:
```bash
cd frontend
npm run dev
```

ุงูุชุญ ุงููุชุตูุญ ุนูู: http://localhost:3000

---

## ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ

### ุณููุงุฑูู 1: ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ

1. ุณุฌู ุงูุฏุฎูู ููุดุฑู ูุณู (0900000003 / dept123)
2. ุฃูุดุฆ ุทูุจ ุฌุฏูุฏ ุจุนูุงุตุฑ
3. ุชุญูู ูู ุธููุฑ ุงูุทูุจ ูู ูุงุฆูุฉ ุงูุทูุจุงุช

### ุณููุงุฑูู 2: ูุนุงูุฌุฉ ุงูุทูุจ

1. ุณุฌู ุงูุฏุฎูู ูููุธู ูุณุชูุฏุน (0900000001 / warehouse123)
2. ุนุฑุถ ุงูุทูุจุงุช ุงูุฌุฏูุฏุฉ
3. ูู ุจุชุบููุฑ ุญุงูุฉ ุงูุทูุจ ุฅูู "ููุฏ ุงููุฑุงุฌุนุฉ"
4. ุซู ุฅูู "ููุฏ ุงูุชุฌููุฒ"
5. ุซู ุฅูู "ุฌุงูุฒ ููุชูุตูู"

### ุณููุงุฑูู 3: ุชูุตูู ุงูุทูุจ

1. ุณุฌู ุงูุฏุฎูู ูุณุงุฆู (0900000002 / driver123)
2. ุนุฑุถ ุงูุทูุจุงุช ุงูุฌุงูุฒุฉ ููุชูุตูู
3. ูู ุจุชุบููุฑ ุงูุญุงูุฉ ุฅูู "ุชู ุงูุชุณููู"

---

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดููุฉ: ูุง ูููู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุงูุญู:**
```bash
# ุชุญูู ูู ุชุดุบูู PostgreSQL
sudo systemctl status postgresql

# ุฅุฐุง ูู ููู ูุนููุ ูู ุจุชุดุบููู
sudo systemctl start postgresql
```

### ูุดููุฉ: ุฎุทุฃ ูู ูููุฉ ุงููุฑูุฑ

**ุงูุญู:**
```bash
# ุฃุนุฏ ุชุนููู ูููุฉ ูุฑูุฑ postgres
sudo -u postgres psql -c "ALTER USER postgres PASSWORD 'password';"
```

### ูุดููุฉ: ูุงุนุฏุฉ ุงูุจูุงูุงุช ุบูุฑ ููุฌูุฏุฉ

**ุงูุญู:**
```bash
# ุฃุนุฏ ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช
psql -U postgres -h localhost -c "CREATE DATABASE orderlink;"
cd backend
npx prisma db push
npm run seed
```

### ูุดููุฉ: ุงูุฌุฏุงูู ูุงุฑุบุฉ

**ุงูุญู:**
```bash
# ุฃุนุฏ ุชุนุจุฆุฉ ุงูุจูุงูุงุช
cd backend
npm run seed
```

---

## ุงููุณุฎ ุงูุงุญุชูุงุทู ูุงูุงุณุชุนุงุฏุฉ

### ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ

```bash
pg_dump -U postgres -h localhost orderlink > backup_$(date +%Y%m%d_%H%M%S).sql
```

### ุงุณุชุนุงุฏุฉ ูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ

```bash
psql -U postgres -h localhost -d orderlink < backup_20241126_131335.sql
```

---

## ุงูุชุฑุญูู ุฅูู Supabase ูุงุญูุงู

ุนูุฏูุง ุชููู ุฌุงูุฒุงู ููุชุฑุญูู ุฅูู Supabase:

### 1. ุชุตุฏูุฑ ุงูุจูุงูุงุช

```bash
pg_dump -U postgres -h localhost --data-only orderlink > data_export.sql
```

### 2. ุชุญุฏูุซ DATABASE_URL

ูู ููู `.env`:
```bash
DATABASE_URL="postgresql://postgres:PASSWORD@db.ywihxwhxbyurabitbvcu.supabase.co:5432/postgres"
```

### 3. ุฏูุน ุงููุฎุทุท

```bash
npx prisma db push
```

### 4. ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช

ุงุณุชุฎุฏู SQL Editor ูู Supabase ูุชุดุบูู ูุญุชูู `data_export.sql`

---

## ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฌุงูุฒุฉ
2. โ ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ ููุฌูุฏุฉ
3. โ Backend ูุนูู
4. โ Frontend ูุนูู

**ููููู ุงูุขู:**
- ุงูุจุฏุก ูู ุชุทููุฑ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ
- ุงุฎุชุจุงุฑ ูุงุฌูุงุช API
- ุชุทููุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู
- ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ

---

## ุงูููุงุฑุฏ

- [Prisma Documentation](https://www.prisma.io/docs)
- [PostgreSQL Documentation](https://www.postgresql.org/docs/)
- [Backend README](file:///home/ayb/Documents/OrderLink_HCO/backend/README.md)
- [Seed Script](file:///home/ayb/Documents/OrderLink_HCO/backend/prisma/seed.ts)
- [Database Schema](file:///home/ayb/Documents/OrderLink_HCO/backend/prisma/schema.prisma)

---

## ููุฎุต ุงูุฅุนุฏุงุฏ

โ **ูุงุนุฏุฉ ุงูุจูุงูุงุช**: orderlink  
โ **ุงูุฌุฏุงูู**: 4 (users, orders, order_items, order_history)  
โ **ุงููุณุชุฎุฏููู**: 6 (1 admin, 1 warehouse, 1 driver, 3 departments)  
โ **ุงูุงุชุตุงู**: localhost:5432  
โ **Prisma**: ููุนุฏ ููุนูู  
โ **Backend**: ูุชุตู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช  

๐ **ุงููุธุงู ุฌุงูุฒ ููุชุทููุฑ!**
