# تحسينات على نظام التصفية وعرض الجدول

## التاريخ
2025-12-01

## الملخص
تم إجراء تحسينين رئيسيين على صفحة إدارة المواد:
1. عرض فقط القيم الموجودة فعلياً في البيانات ضمن خيارات التصفية
2. الحفاظ على رؤوس الجدول حتى عند عدم وجود بيانات

## التغييرات المنفذة

### 1. تصفية القيم الموجودة فقط

#### المشكلة السابقة
كانت خيارات التصفية تعرض جميع القيم المحتملة حتى لو لم تكن موجودة في البيانات الحالية. مثلاً:
- عمود الحالة كان يعرض "نشط" و "غير نشط" حتى لو كانت جميع المواد نشطة
- عند اختيار "غير نشط"، كان الجدول يختفي بالكامل مع رسالة "لا توجد مواد"

#### الحل
تم تعديل استخراج القيم الفريدة لتعتمد على البيانات الفعلية:

```tsx
// قبل التعديل
const uniqueStatuses = ["active", "inactive"]

// بعد التعديل
const uniqueStatuses = Array.from(new Set(items.map(i => i.isActive ? "active" : "inactive")))
```

الآن:
- إذا كانت جميع المواد نشطة، سيظهر فقط خيار "نشط" في قائمة التصفية
- إذا كانت جميع المواد غير نشطة، سيظهر فقط خيار "غير نشط"
- إذا كان هناك مزيج، سيظهر الخياران

هذا ينطبق على جميع الأعمدة:
- الفئة
- المستودع
- الوحدة
- الحالة
- المنشئ

### 2. الحفاظ على رؤوس الجدول

#### المشكلة السابقة
عند عدم وجود مواد (بسبب البحث أو التصفية)، كان الجدول بالكامل يختفي ويظهر فقط رسالة "لا توجد مواد" في منتصف الشاشة.

#### الحل
تم تعديل بنية الجدول بحيث:
1. تبقى رؤوس الجدول (TableHeader) مرئية دائماً
2. عند عدم وجود بيانات، يتم عرض صف واحد في TableBody يحتوي على رسالة "لا توجد مواد"

```tsx
<TableBody>
  {paginatedItems.length === 0 ? (
    <TableRow>
      <TableCell 
        colSpan={visibleColumns.size + 2} 
        className="h-24 text-center"
      >
        <p className="text-muted-foreground">لا توجد مواد</p>
      </TableCell>
    </TableRow>
  ) : (
    paginatedItems.map((item) => (
      // ... عرض الصفوف
    ))
  )}
</TableBody>
```

#### الفوائد
- تجربة مستخدم أفضل: المستخدم يرى دائماً بنية الجدول
- سياق واضح: يعرف المستخدم أي الأعمدة موجودة حتى عند عدم وجود بيانات
- اتساق في الواجهة: الجدول لا يختفي ويظهر بشكل مفاجئ

## الملفات المعدلة
- `/frontend/src/app/(dashboard-layout)/items/manage/page.tsx`

## النتيجة النهائية
الآن عند استخدام التصفية:
1. تظهر فقط الخيارات الموجودة فعلياً في البيانات
2. رؤوس الجدول تبقى مرئية دائماً
3. عند عدم وجود نتائج، تظهر رسالة "لا توجد مواد" داخل الجدول نفسه
